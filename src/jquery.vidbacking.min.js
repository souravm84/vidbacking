!function($){$.fn.vidbacking=function(options){var settings=$.extend({"video-opacity":"1",masked:!1,"mask-opacity":"1","youtube-mute-video":!0,"youtube-loop":!0},options);return this.each((function(){var targetobj=$(this),targettag=targetobj.prop("tagName"),targetid=targetobj.prop("id");if("BODY"==targettag){if(obj=$(".vidbacking"),objtag=obj.prop("tagName"),"IFRAME"==objtag){var youtube_source=obj.attr("src")+"?autoplay=1&rel=0&controls=0&showinfo=0",video_url_parts,video_id=(video_url_parts=obj.attr("src").split("/"))[video_url_parts.length-1];1==settings["youtube-mute-video"]&&(youtube_source+="&mute=1"),1==settings["youtube-loop"]&&(youtube_source+="&loop=1&playlist="+video_id),obj.attr("src",youtube_source),obj.addClass("vidbacking-active-body-back-youtube");var winh=$(window).height(),winw=$(window).width(),vidh=obj.height(),vidw=obj.width(),wre=winw/winh,hre=winh/winw;winw>winh?wre<1.77?(expected_width=winh*(16/9),obj.css("width",expected_width+"px"),obj.css("height","100%")):(expected_height=winw/(16/9),obj.css("width","100%"),obj.css("height",expected_height+"px")):hre<.56?(expected_height=winw/(16/9),obj.css("width","100%"),obj.css("height",expected_height+"px")):(expected_width=winh*(16/9),obj.css("width",expected_width+"px"),obj.css("height","100%"))}else poster=obj.attr("poster"),obj.css("background-size","100% 100% !important"),obj.css("background-image","url("+poster+")"),obj.addClass("vidbacking-active-body-back"),obj.css("opacity",settings["video-opacity"]);obj.removeClass("vidbacking"),1==settings.masked&&(obj.after('<div class="vidmask-body-back">&nbsp;</div>'),$(".vidmask-body-back").css("opacity",settings["mask-opacity"])),$(window).resize((function(){var winh=$(window).height(),winw=$(window).width(),vidh=obj.height(),vidw=obj.width(),wre,hre=winh/winw;"IFRAME"==objtag?winw>winh?winw/winh<1.77?(expected_width=winh*(16/9),obj.css("width",expected_width+"px"),obj.css("height","100%")):(expected_height=winw/(16/9),obj.css("width","100%"),obj.css("height",expected_height+"px")):hre<.56?(expected_height=winw/(16/9),obj.css("width","100%"),obj.css("height",expected_height+"px")):(expected_width=winh*(16/9),obj.css("width",expected_width+"px"),obj.css("height","100%")):(vidh<winh&&obj.css("height",winh),vidw<winw&&obj.css("width",winw))}))}else{if(obj=$(this).find(".vidbacking"),objtag=obj.prop("tagName"),"IFRAME"==objtag){var youtube_source=obj.attr("src")+"?autoplay=1&rel=0&controls=0&showinfo=0",video_url_parts,video_id=(video_url_parts=obj.attr("src").split("/"))[video_url_parts.length-1];1==settings["youtube-mute-video"]&&(youtube_source+="&mute=1"),1==settings["youtube-loop"]&&(youtube_source+="&loop=1&playlist="+video_id),obj.attr("src",youtube_source),obj.addClass("vidbacking-active-block-back-youtube"),targetobj.css("position","relative"),targetobj.css("overflow","hidden");var winh=targetobj.outerHeight(),winw=targetobj.width(),vidh=obj.height(),vidw=obj.width(),wre=winw/winh,hre=winh/winw;winw>winh?wre<1.77?(expected_width=winh*(16/9),obj.css("width",expected_width+"px"),obj.css("height","100%")):(expected_height=winw/(16/9),obj.css("width","100%"),obj.css("height",expected_height+"px")):hre<.56?(expected_height=winw/(16/9),obj.css("width","100%"),obj.css("height",expected_height+"px")):(expected_width=winh*(16/9),obj.css("width",expected_width+"px"),obj.css("height","100%"))}else poster=obj.attr("poster"),targetobj.css("position","relative"),targetobj.css("overflow","hidden"),obj.css("background-image","url("+poster+")"),obj.addClass("vidbacking-active-block-back"),obj.css("opacity",settings["video-opacity"]);obj.removeClass("vidbacking"),1==settings.masked&&(targetobj.append('<div class="vidmask-block-back">&nbsp;</div>'),targetobj.find(".vidmask-block-back").css("opacity",settings["mask-opacity"])),$(window).resize((function(){var winh=targetobj.outerHeight(),winw=targetobj.width(),vidh=obj.height(),vidw=obj.width(),wre,hre=winh/winw;"IFRAME"==objtag?winw>winh?winw/winh<1.77?(expected_width=winh*(16/9),obj.css("width",expected_width+"px"),obj.css("height","100%")):(expected_height=winw/(16/9),obj.css("width","100%"),obj.css("height",expected_height+"px")):hre<.56?(expected_height=winw/(16/9),obj.css("width","100%"),obj.css("height",expected_height+"px")):(expected_width=winh*(16/9),obj.css("width",expected_width+"px"),obj.css("height","100%")):(vidh<winh&&obj.css("height",winh),vidw<winw&&obj.css("width",winw))})),$(window).scroll((function(){var top=$(window).scrollTop(),left=$(window).scrollLeft(),winheight=$(window).height(),target_element_position=targetobj.offset(),target_element_bottom,window_bottom=winheight+top;if((targetobj.outerHeight()+target_element_position.top<top||target_element_position.top>window_bottom)&&"VIDEO"==objtag){if(!obj[0].paused)try{obj[0].pause()}catch(e){console.error(e)}}else if(obj[0].paused)try{obj[0].play()}catch(e){console.error(e)}}))}}))}}(jQuery);